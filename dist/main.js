document.addEventListener("DOMContentLoaded",()=>{const s=[{id:"krasniy-zeleniy",name:"\u041A\u0440\u0430\u0441\u043D\u044B\u0439 \u2014 \u0437\u0435\u043B\u0451\u043D\u044B\u0439",path:"games/krasniy-zeleniy/",initFunction:"initKrasniyZeleniy"},{id:"naydi-paru",name:"\u041D\u0430\u0439\u0434\u0438 \u043F\u043E\u0445\u043E\u0436\u0443\u044E \u043F\u0430\u0440\u0443",path:"games/naydi-paru/",initFunction:"initNaydiParu"},{id:"sosedi",name:"\u0421\u043E\u0441\u0435\u0434\u0438",path:"games/sosedi/",initFunction:"initSosedi"},{id:"druzya",name:"\u0414\u0440\u0443\u0437\u044C\u044F",path:"games/druzya/",initFunction:"initDruzya"},{id:"chetvertiy-lishniy",name:"\u0427\u0435\u0442\u0432\u0451\u0440\u0442\u044B\u0439 \u043B\u0438\u0448\u043D\u0438\u0439",path:"games/chetvertiy-lishniy/",initFunction:"initChetvertiyLishniy"},{id:"naydi-mesto",name:"\u041D\u0430\u0439\u0434\u0438 \u043C\u0435\u0441\u0442\u043E \u043A\u0430\u0440\u0442\u0438\u043D\u043A\u0435",path:"games/naydi-mesto/",initFunction:"initNaydiMesto"},{id:"samiy-vnimatelniy",name:"\u0421\u0430\u043C\u044B\u0439 \u0432\u043D\u0438\u043C\u0430\u0442\u0435\u043B\u044C\u043D\u044B\u0439",path:"games/samiy-vnimatelniy/",initFunction:"initSamiyVnimatelniy"},{id:"ugaday-imya",name:"\u0423\u0433\u0430\u0434\u0430\u0439 \u0438\u043C\u044F",path:"games/ugaday-imya/",initFunction:"initUgadaiImya"},{id:"privetstvie",name:"\u041F\u0440\u0438\u0432\u0435\u0442\u0441\u0442\u0432\u0438\u0435",path:"games/privetstvie/",initFunction:"initPrivetstvie"},{id:"robot",name:"\u0420\u043E\u0431\u043E\u0442",path:"games/robot/",initFunction:"initRobot"},{id:"naydi-zvuk",name:"\u041D\u0430\u0439\u0434\u0438 \u0437\u0432\u0443\u043A",path:"games/naydi-zvuk/",initFunction:"initNaydiZvuk"},{id:"soberi-gribi",name:"\u0421\u043E\u0431\u0435\u0440\u0438 \u0433\u0440\u0438\u0431\u044B",path:"games/soberi-gribi/",initFunction:"initSoberiGribi"},{id:"uborka",name:"\u0423\u0431\u043E\u0440\u043A\u0430",path:"games/uborka/",initFunction:"initUborka"},{id:"gde-zvuk",name:"\u0413\u0434\u0435 \u0437\u0432\u0443\u043A?",path:"games/gde-zvuk/",initFunction:"initGdeZvuk"},{id:"poschitay",name:"\u041F\u043E\u0441\u0447\u0438\u0442\u0430\u0439",path:"games/poschitay/",initFunction:"initPoschitay"},{id:"spoy-pesenku",name:"\u0421\u043F\u043E\u0439 \u043F\u0435\u0441\u0435\u043D\u043A\u0443",path:"games/spoy-pesenku/",initFunction:"initSpoyPesenku"}],o=document.getElementById("games-menu"),a=document.getElementById("game-container"),d=document.getElementById("game-specific-styles"),h=document.getElementById("home-link");function p(){const i=document.createElement("ul");s.forEach(t=>{const e=document.createElement("li"),n=document.createElement("button");n.textContent=t.name,n.dataset.gameId=t.id,e.appendChild(n),i.appendChild(e)}),o.innerHTML="",o.appendChild(i)}async function r(i){const t=s.find(e=>e.id===i);if(!t){console.error(`\u0418\u0433\u0440\u0430 \u0441 ID "${i}" \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430.`);return}window.UI&&(UI.clearToasts?.(),UI.clearOverlays?.()),a.innerHTML='<div class="loader">\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...</div>',d.innerHTML="";try{const[e,n,m]=await Promise.all([fetch(`${t.path}index.html`),fetch(`${t.path}style.css`),fetch(`${t.path}script.js`)]);if(!e.ok)throw new Error(`\u041D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D \u0444\u0430\u0439\u043B: ${e.url}`);if(!n.ok)throw new Error(`\u041D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D \u0444\u0430\u0439\u043B: ${n.url}`);if(!m.ok)throw new Error(`\u041D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D \u0444\u0430\u0439\u043B: ${m.url}`);const[g,b,f]=await Promise.all([e.text(),n.text(),m.text()]);a.classList.remove("home");const l=document.createElement("div");l.className="game-shell",l.innerHTML=`
              <div class="game-toolbar">
                <div class="toolbar-left">
                  <button class="icon-btn" id="btn-back"><span class="iconify" data-icon="solar:arrow-left-linear"></span>\u041D\u0430\u0437\u0430\u0434</button>
                </div>
                <div class="toolbar-right">
                  <button class="icon-btn" id="btn-restart"><span class="iconify" data-icon="solar:refresh-linear"></span>\u0421\u0431\u0440\u043E\u0441</button>
                </div>
              </div>
              <div class="game-stage animate__animated animate__fadeIn">${g}</div>`,a.innerHTML="",a.appendChild(l),d.innerHTML=b;const u=document.createElement("script");if(u.textContent=f,document.body.appendChild(u),typeof window[t.initFunction]=="function")window[t.initFunction]();else throw new Error(`\u0424\u0443\u043D\u043A\u0446\u0438\u044F \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u0438 "${t.initFunction}" \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430.`);document.body.removeChild(u);const k=document.getElementById("btn-back"),E=document.getElementById("btn-restart");k?.addEventListener("click",y=>{y.preventDefault(),c()}),E?.addEventListener("click",y=>{y.preventDefault(),r(i)})}catch(e){console.error(`\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0438\u0433\u0440\u044B "${t.name}":`,e),a.innerHTML='<div class="error-message">\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0433\u0440\u0443. \u041F\u0440\u043E\u0432\u0435\u0440\u044C\u0442\u0435 \u043A\u043E\u043D\u0441\u043E\u043B\u044C \u0440\u0430\u0437\u0440\u0430\u0431\u043E\u0442\u0447\u0438\u043A\u0430 (F12) \u0434\u043B\u044F \u0434\u0435\u0442\u0430\u043B\u0435\u0439.</div>'}}function c(){window.UI&&(UI.clearToasts?.(),UI.clearOverlays?.());const i=s.map(e=>`
          <div class="home-card card" data-game-id="${e.id}">
            <div class="home-emoji">${e.emoji||"\u{1F3AE}"}</div>
            <div class="home-title">${e.name}</div>
          </div>`).join("");a.innerHTML=`<div class="grid home-grid">${i}</div>`,d.innerHTML="",a.classList.add("home");const t=a.querySelector(".home-grid");[...t.children].forEach((e,n)=>{e.classList.add("animate__animated","animate__fadeInUp"),e.style.setProperty("--animate-duration","600ms"),e.style.animationDelay=`${n*40}ms`}),t.addEventListener("click",e=>{const n=e.target.closest(".home-card");n&&r(n.dataset.gameId)})}o.addEventListener("click",i=>{i.target.tagName==="BUTTON"&&r(i.target.dataset.gameId)}),h.addEventListener("click",i=>{i.preventDefault(),c()});const v={"krasniy-zeleniy":"\u{1F34F}","naydi-paru":"\u{1F9E9}",sosedi:"\u{1F3E0}",druzya:"\u{1F467}\u{1F466}","chetvertiy-lishniy":"4\uFE0F\u20E3","naydi-mesto":"\u{1F9ED}","samiy-vnimatelniy":"\u{1F9E0}","ugaday-imya":"\u{1F47D}",privetstvie:"\u{1F44B}",robot:"\u{1F916}","naydi-zvuk":"\u{1F50E}","soberi-gribi":"\u{1F344}",uborka:"\u{1F9FA}","gde-zvuk":"\u{1F682}",poschitay:"\u{1F522}","spoy-pesenku":"\u{1F3B5}"};s.forEach(i=>i.emoji=v[i.id]||"\u{1F3AE}"),p(),c()});
