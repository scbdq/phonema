const{speak,shuffle,setFeedback,updateProgress,initSpeechWarmup}=window.GameUtils,itemsContainer=document.getElementById("items-container"),boxLeft=document.getElementById("box-left"),boxRight=document.getElementById("box-right"),feedback=document.getElementById("feedback"),progress=document.getElementById("progress");initSpeechWarmup();const rounds=[{leftTitle:"\u041A\u043E\u0440\u043E\u0431\u043A\u0430 \xAB\u0410\xBB",leftTag:"\u0421\u043B\u043E\u0432\u0430 \u043D\u0430 \u0437\u0432\u0443\u043A \u0410",rightTitle:"\u041A\u043E\u0440\u043E\u0431\u043A\u0430 \xAB\u0423\xBB",rightTag:"\u0421\u043B\u043E\u0432\u0430 \u043D\u0430 \u0437\u0432\u0443\u043A \u0423",words:[{word:"\u0443\u043B\u0435\u0439",side:"right"},{word:"\u0443\u0442\u043A\u0430",side:"right"},{word:"\u0443\u0440\u043D\u0430",side:"right"},{word:"\u0443\u0436",side:"right"},{word:"\u0430\u0438\u0441\u0442",side:"left"},{word:"\u0430\u0441\u0442\u0440\u0430",side:"left"},{word:"\u0430\u043D\u0430\u043D\u0430\u0441",side:"left"},{word:"\u0430\u0440\u0431\u0443\u0437",side:"left"}]},{leftTitle:"\u041A\u043E\u0440\u043E\u0431\u043A\u0430 \xAB\u041C\xBB",leftTag:"\u0421\u043B\u043E\u0432\u0430 \u043D\u0430 \u0437\u0432\u0443\u043A \u041C",rightTitle:"\u041A\u043E\u0440\u043E\u0431\u043A\u0430 \xAB\u041F\xBB",rightTag:"\u0421\u043B\u043E\u0432\u0430 \u043D\u0430 \u0437\u0432\u0443\u043A \u041F",words:[{word:"\u043C\u0430\u043A",side:"left"},{word:"\u043C\u0443\u043A\u0430",side:"left"},{word:"\u043C\u044B\u0448\u043A\u0430",side:"left"},{word:"\u043C\u0438\u0441\u043A\u0430",side:"left"},{word:"\u043F\u0430\u043B\u043A\u0430",side:"right"},{word:"\u043F\u0430\u043A\u0435\u0442",side:"right"},{word:"\u043F\u043E\u043D\u0438",side:"right"},{word:"\u043F\u0430\u0443\u043A",side:"right"},{word:"\u043F\u0438\u0440\u0430\u0442",side:"right"}]}];let currentIndex=0,selected=null;function showRound(){if(currentIndex>=rounds.length){finishGame();return}const e=rounds[currentIndex];setBoxContent(boxLeft,e.leftTitle,e.leftTag),setBoxContent(boxRight,e.rightTitle,e.rightTag),itemsContainer.innerHTML="",selected=null,shuffle(e.words.slice()).forEach((n,i)=>{const t=document.createElement("button");t.type="button",t.className="word-card",t.dataset.side=n.side,t.dataset.word=n.word;const s=document.createElement("span");s.className="emoji",s.textContent="\u{1F9F8}",s.setAttribute("aria-hidden","true"),t.appendChild(s);const o=document.createElement("strong");o.textContent=n.word.charAt(0).toUpperCase()+n.word.slice(1),t.appendChild(o),t.addEventListener("click",()=>selectItem(t,n.word)),itemsContainer.appendChild(t)}),updateProgress(progress,currentIndex+1,rounds.length),setFeedback(feedback,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043F\u0440\u0435\u0434\u043C\u0435\u0442 \u0438 \u043F\u043E\u043B\u043E\u0436\u0438\u0442\u0435 \u0435\u0433\u043E \u0432 \u043F\u043E\u0434\u0445\u043E\u0434\u044F\u0449\u0443\u044E \u043A\u043E\u0440\u043E\u0431\u043A\u0443.","info")}function setBoxContent(e,d,n){e.innerHTML="";const i=document.createElement("div");i.className="stack",i.style.alignItems="center";const t=document.createElement("strong");t.textContent=d;const s=document.createElement("span");s.className="tag",s.textContent=n,i.appendChild(t),i.appendChild(s),e.appendChild(i)}function selectItem(e,d){e.classList.contains("placed")||(selected&&selected.classList.remove("selected"),selected=e,e.classList.add("selected"),speak(d,{rate:1.05}),setFeedback(feedback,"\u0422\u0435\u043F\u0435\u0440\u044C \u043D\u0430\u0436\u043C\u0438\u0442\u0435 \u043D\u0430 \u043A\u043E\u0440\u043E\u0431\u043A\u0443, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u043B\u043E\u0436\u0438\u0442\u044C \u043F\u0440\u0435\u0434\u043C\u0435\u0442.","info"))}function placeInBox(e,d){if(!selected){setFeedback(feedback,"\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043F\u0440\u0435\u0434\u043C\u0435\u0442.","error");return}selected.dataset.side===d?(selected.classList.remove("selected"),selected.classList.add("placed"),selected.disabled=!0,e.appendChild(selected),selected=null,setFeedback(feedback,"\u041F\u0440\u0435\u0434\u043C\u0435\u0442 \u043D\u0430 \u0441\u0432\u043E\u0451\u043C \u043C\u0435\u0441\u0442\u0435!","success"),checkCompletion()):(selected.classList.add("wrong"),setFeedback(feedback,"\u042D\u0442\u0430 \u043A\u043E\u0440\u043E\u0431\u043A\u0430 \u043D\u0435 \u043F\u043E\u0434\u0445\u043E\u0434\u0438\u0442. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0434\u0440\u0443\u0433\u0443\u044E.","error"),setTimeout(()=>selected.classList.remove("wrong"),800))}function checkCompletion(){itemsContainer.querySelectorAll(".word-card:not(.placed)").length===0&&(setFeedback(feedback,"\u041A\u043E\u0440\u043E\u0431\u043A\u0438 \u0437\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u044B \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E! \u041F\u0435\u0440\u0435\u0445\u043E\u0434\u0438\u043C \u043A \u0441\u043B\u0435\u0434\u0443\u044E\u0449\u0435\u043C\u0443 \u0437\u0430\u0434\u0430\u043D\u0438\u044E.","success"),currentIndex+=1,setTimeout(showRound,1300))}boxLeft.addEventListener("click",()=>placeInBox(boxLeft,"left")),boxRight.addEventListener("click",()=>placeInBox(boxRight,"right"));function finishGame(){setFeedback(feedback,"\u0412\u044B \u043E\u0442\u043B\u0438\u0447\u043D\u043E \u0441\u043F\u0440\u0430\u0432\u0438\u043B\u0438\u0441\u044C \u0441 \u0443\u0431\u043E\u0440\u043A\u043E\u0439!","success"),updateProgress(progress,rounds.length,rounds.length)}showRound();
