const{speak,speakSequence,shuffle,setFeedback,updateProgress,wait,initSpeechWarmup,cancelSpeech}=window.GameUtils,leftCard=document.getElementById("left-card"),rightCard=document.getElementById("right-card"),leftWord=document.getElementById("left-word"),rightWord=document.getElementById("right-word"),progress=document.getElementById("progress"),feedback=document.getElementById("feedback"),playPairBtn=document.getElementById("play-pair"),similarBtn=document.getElementById("btn-similar"),differentBtn=document.getElementById("btn-different");initSpeechWarmup();const rounds=shuffle([{words:["\u043B\u0438\u0441\u0430","\u043A\u043E\u0441\u0430"],emoji:["\u{1F98A}","\u{1F33E}"],similar:!1},{words:["\u043A\u043E\u043D\u0444\u0435\u0442\u0430","\u043A\u0443\u0431\u0438\u043A"],emoji:["\u{1F36C}","\u{1F9CA}"],similar:!1},{words:["\u0431\u0430\u0442\u043E\u043D","\u0431\u0443\u0442\u043E\u043D"],emoji:["\u{1F35E}","\u{1F337}"],similar:!0},{words:["\u0431\u0430\u043D\u043A\u0430","\u043C\u0430\u043D\u043A\u0430"],emoji:["\u{1F96B}","\u{1F963}"],similar:!0},{words:["\u0431\u0435\u0433\u0435\u043C\u043E\u0442","\u0442\u0430\u043D\u043A"],emoji:["\u{1F99B}","\u{1F69C}"],similar:!1},{words:["\u0434\u043E\u043C","\u043A\u043E\u043C"],emoji:["\u{1F3E0}","\u{1FAA8}"],similar:!0}]);let currentIndex=0,score=0,finished=!1;function showRound(){if(currentIndex>=rounds.length){finishGame();return}const e=rounds[currentIndex];leftWord.textContent=capitalize(e.words[0]),rightWord.textContent=capitalize(e.words[1]),leftCard.querySelector(".emoji").textContent=e.emoji[0],rightCard.querySelector(".emoji").textContent=e.emoji[1],updateProgress(progress,currentIndex+1,rounds.length),setFeedback(feedback,"\u0421\u043B\u0443\u0448\u0430\u0439\u0442\u0435 \u0441\u043B\u043E\u0432\u0430 \u0438 \u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0438\u0442\u0435, \u043F\u043E\u0445\u043E\u0436\u0438 \u043B\u0438 \u043E\u043D\u0438 \u043F\u043E \u0437\u0432\u0443\u0447\u0430\u043D\u0438\u044E.","info"),speakPair()}function capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}function speakPair(){const e=rounds[currentIndex];cancelSpeech(),speakSequence(e.words,{speechOptions:{rate:1.05,pitch:1.08},pause:500})}async function handleAnswer(e){if(finished)return;similarBtn.disabled=!0,differentBtn.disabled=!0;const t=rounds[currentIndex];t.similar===e?(score+=1,setFeedback(feedback,"\u0412\u0435\u0440\u043D\u043E! \u042D\u0442\u0438 \u0441\u043B\u043E\u0432\u0430 \u0437\u0432\u0443\u0447\u0430\u0442 \u043F\u043E\u0434\u0445\u043E\u0434\u044F\u0449\u0435.","success")):t.similar?setFeedback(feedback,"\u042D\u0442\u0438 \u0441\u043B\u043E\u0432\u0430 \u0432\u0441\u0451-\u0442\u0430\u043A\u0438 \u0437\u0432\u0443\u0447\u0430\u0442 \u043F\u043E\u0445\u043E\u0436\u0435.","error"):setFeedback(feedback,"\u0421\u043B\u043E\u0432\u0430 \u0437\u0432\u0443\u0447\u0430\u0442 \u043F\u043E-\u0440\u0430\u0437\u043D\u043E\u043C\u0443.","error"),currentIndex+=1,await wait(1300),similarBtn.disabled=!1,differentBtn.disabled=!1,showRound()}function finishGame(){finished=!0,updateProgress(progress,rounds.length,rounds.length),setFeedback(feedback,`\u0413\u043E\u0442\u043E\u0432\u043E! \u041F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0445 \u043E\u0442\u0432\u0435\u0442\u043E\u0432: ${score} \u0438\u0437 ${rounds.length}. \u041D\u0430\u0436\u043C\u0438\u0442\u0435 \u043A\u043D\u043E\u043F\u043A\u0443 \xAB\u0418\u0433\u0440\u0430\u0442\u044C \u0441\u043D\u043E\u0432\u0430\xBB, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u044C.`,"success"),playPairBtn.textContent="\u{1F501} \u0418\u0433\u0440\u0430\u0442\u044C \u0441\u043D\u043E\u0432\u0430",playPairBtn.disabled=!1,similarBtn.disabled=!0,differentBtn.disabled=!0}function restartGame(){currentIndex=0,score=0,finished=!1;const e=shuffle(rounds);rounds.splice(0,rounds.length,...e),playPairBtn.textContent="\u25B6\uFE0F \u041F\u0440\u043E\u0441\u043B\u0443\u0448\u0430\u0442\u044C \u0441\u043B\u043E\u0432\u0430",similarBtn.disabled=!1,differentBtn.disabled=!1,showRound()}playPairBtn.addEventListener("click",()=>{finished?restartGame():speakPair()}),similarBtn.addEventListener("click",()=>handleAnswer(!0)),differentBtn.addEventListener("click",()=>handleAnswer(!1)),leftCard.addEventListener("click",()=>speak(rounds[currentIndex].words[0],{rate:1.05,pitch:1.08})),rightCard.addEventListener("click",()=>speak(rounds[currentIndex].words[1],{rate:1.05,pitch:1.08})),showRound();
