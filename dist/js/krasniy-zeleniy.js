const{speak,wait,shuffle,setFeedback,updateProgress,disableButtons,enableButtons,cancelSpeech,initSpeechWarmup}=window.GameUtils,objectCard=document.getElementById("object-card"),emojiSpan=objectCard.querySelector(".emoji"),objectName=document.getElementById("object-name"),repeatButton=document.getElementById("repeat-word"),correctButton=document.getElementById("answer-correct"),incorrectButton=document.getElementById("answer-incorrect"),feedback=document.getElementById("feedback"),progress=document.getElementById("progress");initSpeechWarmup();const objects=[{title:"\u0411\u0430\u043D\u0430\u043D",emoji:"\u{1F34C}",sequence:[{word:"\u043A\u0430\u0431\u0430\u043D",correct:!1},{word:"\u043D\u0430\u0433\u0430\u043D",correct:!1},{word:"\u0431\u0430\u043D\u0430\u043D",correct:!0},{word:"\u043B\u0430\u0434\u0430\u043D",correct:!1},{word:"\u0431\u0430\u043D\u0430\u043D",correct:!0},{word:"\u043D\u0430\u0431\u0430\u043D",correct:!1},{word:"\u0431\u0430\u043D\u0430\u043D",correct:!0},{word:"\u043A\u0430\u0437\u0430\u043D",correct:!1}]},{title:"\u0411\u0443\u0434\u043A\u0430",emoji:"\u{1F436}",sequence:[{word:"\u0431\u0443\u0434\u043A\u0430",correct:!0},{word:"\u0434\u0443\u0434\u043A\u0430",correct:!1},{word:"\u0443\u0442\u043A\u0430",correct:!1},{word:"\u0431\u0443\u0434\u043A\u0430",correct:!0},{word:"\u0431\u0443\u043A\u0432\u0430",correct:!1},{word:"\u0431\u0443\u0434\u043A\u0430",correct:!0},{word:"\u043A\u0443\u0440\u0442\u043A\u0430",correct:!1},{word:"\u0431\u0443\u0434\u043A\u0430",correct:!0}]},{title:"\u041F\u0430\u043D\u0430\u043C\u0430",emoji:"\u{1F452}",sequence:[{word:"\u0444\u0430\u043D\u0430\u043C\u0430",correct:!1},{word:"\u043A\u0430\u0442\u0430\u043C\u0430",correct:!1},{word:"\u043F\u0430\u043D\u0430\u043C\u0430",correct:!0},{word:"\u0442\u043E\u043C\u0430\u043D\u0430",correct:!1},{word:"\u0441\u0430\u043C\u0430\u043D\u0430",correct:!1},{word:"\u0432\u0430\u0434\u0430\u043C\u0430",correct:!1},{word:"\u043F\u0430\u043D\u0430\u043C\u0430",correct:!0},{word:"\u043D\u0430\u043F\u0430\u043C\u0430",correct:!1}]}],rounds=shuffle(objects).flatMap(e=>e.sequence.map(t=>({...t,title:e.title,emoji:e.emoji})));let currentIndex=0,score=0,isFinished=!1;const buttons=[repeatButton,correctButton,incorrectButton];function showRound(){if(currentIndex>=rounds.length){finishGame();return}const e=rounds[currentIndex];emojiSpan.textContent=e.emoji,objectName.textContent=e.title,updateProgress(progress,currentIndex+1,rounds.length),setFeedback(feedback,"\u0421\u043B\u0443\u0448\u0430\u0439\u0442\u0435 \u0441\u043B\u043E\u0432\u043E \u0438 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043E\u0442\u0432\u0435\u0442.","info"),enableButtons(buttons),playCurrentWord()}function playCurrentWord(){const e=rounds[currentIndex];cancelSpeech(),speak(e.word,{rate:1.05,pitch:e.correct?1.1:.95})}async function checkAnswer(e){if(isFinished)return;disableButtons(buttons);const t=rounds[currentIndex];if(e===t.correct)score+=1,setFeedback(feedback,"\u041E\u0442\u043B\u0438\u0447\u043D\u043E! \u0412\u044B \u0443\u0441\u043B\u044B\u0448\u0430\u043B\u0438 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E.","success");else{const r=t.correct?"\u042D\u0442\u043E \u0441\u043B\u043E\u0432\u043E \u0431\u044B\u043B\u043E \u043F\u0440\u043E\u0438\u0437\u043D\u0435\u0441\u0435\u043D\u043E \u0432\u0435\u0440\u043D\u043E.":"\u0412 \u0441\u043B\u043E\u0432\u0435 \u0431\u044B\u043B\u0430 \u043E\u0448\u0438\u0431\u043A\u0430.";setFeedback(feedback,`\u041F\u043E\u0447\u0442\u0438! ${r}`,"error")}currentIndex+=1,await wait(1300),currentIndex<rounds.length?showRound():finishGame()}function finishGame(){isFinished=!0,updateProgress(progress,rounds.length,rounds.length),emojiSpan.textContent="\u2B50\uFE0F",objectName.textContent="\u0412\u044B \u0431\u043E\u043B\u044C\u0448\u0438\u0435 \u043C\u043E\u043B\u043E\u0434\u0446\u044B!",setFeedback(feedback,`\u0418\u0433\u0440\u0430 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430! \u041F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u044B\u0445 \u043E\u0442\u0432\u0435\u0442\u043E\u0432: ${score} \u0438\u0437 ${rounds.length}. \u041D\u0430\u0436\u043C\u0438\u0442\u0435 \xAB\u0421\u044B\u0433\u0440\u0430\u0442\u044C \u0441\u043D\u043E\u0432\u0430\xBB, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u0432\u0442\u043E\u0440\u0438\u0442\u044C.`,"success"),repeatButton.textContent="\u{1F501} \u0421\u044B\u0433\u0440\u0430\u0442\u044C \u0441\u043D\u043E\u0432\u0430",repeatButton.disabled=!1,correctButton.disabled=!0,incorrectButton.disabled=!0}repeatButton.addEventListener("click",()=>{isFinished?restartGame():playCurrentWord()}),correctButton.addEventListener("click",()=>checkAnswer(!0)),incorrectButton.addEventListener("click",()=>checkAnswer(!1));function restartGame(){currentIndex=0,score=0,isFinished=!1,rounds.splice(0,rounds.length,...shuffle(objects).flatMap(e=>e.sequence.map(t=>({...t,title:e.title,emoji:e.emoji})))),repeatButton.textContent="\u{1F501} \u041F\u043E\u0441\u043B\u0443\u0448\u0430\u0442\u044C \u0435\u0449\u0451 \u0440\u0430\u0437",showRound()}showRound();
