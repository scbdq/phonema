(function(){const u={lang:"ru-RU",rate:1,pitch:1.05,volume:1};function a(e=600){return new Promise(n=>setTimeout(n,e))}function f(){"speechSynthesis"in window&&window.speechSynthesis.cancel()}function s(e,n={}){if(!("speechSynthesis"in window)||!e)return Promise.resolve();const t={...u,...n};return new Promise(i=>{const o=new SpeechSynthesisUtterance(e);o.lang=t.lang,o.rate=t.rate,o.pitch=t.pitch,o.volume=t.volume,o.onend=i,o.onerror=i,window.speechSynthesis.speak(o)})}async function d(e=[],n={}){const{pause:t=550,beforeSpeak:i,afterSpeak:o,speechOptions:c={}}=n;for(const r of e)typeof i=="function"&&i(r),await s(r,c),typeof o=="function"&&o(r),t&&await a(t)}function h(e){const n=e.slice();for(let t=n.length-1;t>0;t-=1){const i=Math.floor(Math.random()*(t+1));[n[t],n[i]]=[n[i],n[t]]}return n}function p(e){if(!(!e||!e.length))return e[Math.floor(Math.random()*e.length)]}function l(e,n="",t="info"){e&&(e.textContent=n,e.className=`feedback${t?` ${t}`:""}`)}function m(e,n,t){e&&(typeof n=="number"&&typeof t=="number"?e.textContent=`\u0420\u0430\u0443\u043D\u0434 ${n} \u0438\u0437 ${t}`:e.textContent="")}function w(e=[]){e.forEach(n=>{n&&(n.disabled=!0)})}function S(e=[]){e.forEach(n=>{n&&(n.disabled=!1)})}function C(e){if(e)for(;e.firstChild;)e.removeChild(e.firstChild)}function b({text:e,emoji:n,id:t,classes:i=[]}){const o=document.createElement("button");if(o.type="button",o.className=["word-card",...i].join(" ").trim(),o.dataset.word=e,t&&(o.id=t),n){const r=document.createElement("span");r.className="emoji",r.textContent=n,r.setAttribute("aria-hidden","true"),o.appendChild(r)}const c=document.createElement("strong");return c.textContent=e,o.appendChild(c),o}function v(){if(!("speechSynthesis"in window))return;const e=()=>{document.removeEventListener("pointerdown",e),document.removeEventListener("keydown",e),s(" ",{rate:1,pitch:1,volume:0}).catch(()=>{})};document.addEventListener("pointerdown",e,{once:!0}),document.addEventListener("keydown",e,{once:!0})}window.GameUtils={wait:a,speak:s,speakSequence:d,shuffle:h,sample:p,setFeedback:l,updateProgress:m,disableButtons:w,enableButtons:S,clearChildren:C,createWordCard:b,cancelSpeech:f,initSpeechWarmup:v}})();
