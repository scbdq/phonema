const{speak,shuffle,setFeedback,initSpeechWarmup}=window.GameUtils,field=document.getElementById("mushroom-field"),basketOne=document.getElementById("basket-one"),basketTwo=document.getElementById("basket-two"),resetButton=document.getElementById("reset-game"),feedback=document.getElementById("feedback"),progress=document.getElementById("progress");initSpeechWarmup();const mushrooms=[{sound:"\u0430",double:!1},{sound:"\u0430\u0443",double:!0},{sound:"\u0430\u043D",double:!0},{sound:"\u043E",double:!1},{sound:"\u043E\u0443",double:!0},{sound:"\u043E\u043D",double:!0},{sound:"\u044D",double:!1},{sound:"\u0437\u0430",double:!0},{sound:"\u044D\u0438",double:!0},{sound:"\u0443",double:!1},{sound:"\u0443\u0434\u0430",double:!0},{sound:"\u0443\u0437",double:!0},{sound:"\u0438",double:!1},{sound:"\u0438\u0430",double:!0},{sound:"\u0438\u0443",double:!0}];let currentMushrooms=[],selected=null;function initGame(){currentMushrooms=shuffle(mushrooms.slice()),field.innerHTML="",basketOne.innerHTML=createBasketContent("\u041A\u043E\u0440\u0437\u0438\u043D\u0430 \xAB1 \u0437\u0432\u0443\u043A\xBB","\u0414\u043B\u044F \u043E\u0434\u0438\u043D\u043E\u0447\u043D\u044B\u0445 \u0437\u0432\u0443\u043A\u043E\u0432"),basketTwo.innerHTML=createBasketContent("\u041A\u043E\u0440\u0437\u0438\u043D\u0430 \xAB2 \u0437\u0432\u0443\u043A\u0430\xBB","\u0414\u043B\u044F \u0437\u0432\u0443\u043A\u043E\u043A\u043E\u043C\u043F\u043B\u0435\u043A\u0441\u043E\u0432"),selected=null,currentMushrooms.forEach((t,n)=>{const e=document.createElement("button");e.type="button",e.className="word-card",e.dataset.index=String(n),e.dataset.double=t.double?"true":"false";const s=document.createElement("span");s.className="emoji",s.textContent="\u{1F344}",s.setAttribute("aria-hidden","true"),e.appendChild(s);const o=document.createElement("strong");o.textContent=`\u0413\u0440\u0438\u0431\u043E\u043A ${n+1}`,e.appendChild(o),e.addEventListener("click",()=>selectMushroom(e,t)),field.appendChild(e)}),updateProgress(),setFeedback(feedback,"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u0440\u0438\u0431\u043E\u043A, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u0441\u043B\u0443\u0448\u0430\u0442\u044C \u0437\u0432\u0443\u043A.","info")}function createBasketContent(t,n){const e=document.createElement("div");e.className="stack",e.style.alignItems="center";const s=document.createElement("strong");s.textContent=t;const o=document.createElement("span");return o.className="tag",o.textContent=n,e.appendChild(s),e.appendChild(o),e}function selectMushroom(t,n){t.classList.contains("placed")||(selected&&selected.card.classList.remove("selected"),selected={card:t,item:n},t.classList.add("selected"),speak(n.sound,{rate:1.05}),setFeedback(feedback,"\u0422\u0435\u043F\u0435\u0440\u044C \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043A\u043E\u0440\u0437\u0438\u043D\u0443, \u043A\u0443\u0434\u0430 \u043F\u043E\u043B\u043E\u0436\u0438\u0442\u044C \u0433\u0440\u0438\u0431\u043E\u043A.","info"))}function placeInBasket(t,n){if(!selected){setFeedback(feedback,"\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0433\u0440\u0438\u0431\u043E\u043A.","error");return}selected.item.double===n?(selected.card.classList.remove("selected"),selected.card.classList.add("placed"),selected.card.disabled=!0,t.appendChild(selected.card),setFeedback(feedback,"\u0413\u0440\u0438\u0431\u043E\u043A \u0432 \u043F\u0440\u0430\u0432\u0438\u043B\u044C\u043D\u043E\u0439 \u043A\u043E\u0440\u0437\u0438\u043D\u0435!","success"),selected=null,updateProgress(),checkCompletion()):(selected.card.classList.add("wrong"),setFeedback(feedback,"\u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0434\u0440\u0443\u0433\u0443\u044E \u043A\u043E\u0440\u0437\u0438\u043D\u0443.","error"),setTimeout(()=>{selected.card.classList.remove("wrong")},800))}function updateProgress(){const t=field.querySelectorAll(".word-card:not(.placed)").length;progress.textContent=`\u041E\u0441\u0442\u0430\u043B\u043E\u0441\u044C ${t} \u0433\u0440\u0438\u0431\u043E\u0432`}function checkCompletion(){field.querySelectorAll(".word-card:not(.placed)").length===0&&setFeedback(feedback,"\u0412\u0441\u0435 \u0433\u0440\u0438\u0431\u044B \u0441\u043E\u0431\u0440\u0430\u043D\u044B! \u041E\u0442\u043B\u0438\u0447\u043D\u0430\u044F \u0440\u0430\u0431\u043E\u0442\u0430.","success")}basketOne.addEventListener("click",()=>placeInBasket(basketOne,!1)),basketTwo.addEventListener("click",()=>placeInBasket(basketTwo,!0)),resetButton.addEventListener("click",()=>{initGame()}),initGame();
