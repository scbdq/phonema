(function(){const n={toasts:[],toastTimers:[],overlay:null};function f(){let t=document.getElementById("global-toast");return t||(t=document.createElement("div"),t.id="global-toast",document.body.appendChild(t)),t}function c(t){t&&(t.classList.add("animate__fadeOutDown"),t.addEventListener("animationend",()=>t.remove(),{once:!0}))}function p(t,o="info",a=1800){const s=f(),e=document.createElement("div");e.className=`toast-item ${o} animate__animated animate__fadeInUp`,e.textContent=t,s.appendChild(e);const i=setTimeout(()=>c(e),a);return n.toastTimers.push(i),n.toasts.push(e),e}function u(){n.toastTimers.forEach(clearTimeout),n.toastTimers.length=0,n.toasts.forEach(c),n.toasts.length=0;const t=document.getElementById("global-toast");t&&(t.innerHTML="")}function d(t={}){if(typeof window.confetti!="function")return;const{particleCount:o=80,spread:a=70,ticks:s=50,scalar:e=1,origin:i={y:.7}}=t;window.confetti({particleCount:o,spread:a,ticks:s,scalar:e,origin:i})}function l(){n.overlay&&(n.overlay.remove(),n.overlay=null)}function y({title:t="\u0420\u0435\u0437\u0443\u043B\u044C\u0442\u0430\u0442",score:o=null,total:a=null,details:s="",onReplay:e=null,onClose:i=null}={}){l();const r=document.createElement("div");r.id="result-overlay",r.innerHTML=`
      <div id="result-card" class="animate__animated animate__zoomIn">
        <h3>${t}</h3>
        ${o!=null&&a!=null?`<p><strong>${o}</strong> \u0438\u0437 <strong>${a}</strong></p>`:""}
        ${s?`<p>${s}</p>`:""}
        <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
          <button id="res-close" class="btn">\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C</button>
          ${e?'<button id="res-replay" class="btn btn-blue">\u0418\u0433\u0440\u0430\u0442\u044C \u0441\u043D\u043E\u0432\u0430</button>':""}
        </div>
      </div>`,document.body.appendChild(r),n.overlay=r,d({particleCount:120,scalar:1.1}),r.querySelector("#res-close").onclick=()=>{l(),typeof i=="function"&&i()};const m=r.querySelector("#res-replay");m&&(m.onclick=()=>{l(),typeof e=="function"&&e()})}function v(){u(),l()}window.UI={toast:p,celebrate:d,result:y,clearToasts:u,clearOverlays:l,reset:v}})();
